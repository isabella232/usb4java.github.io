<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.3 at May 4, 2013 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>usb4java - Quick start</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20130504" />
    <meta http-equiv="Content-Language" content="en" />
                                                    
<link rel="SHORTCUT ICON" href="favicon.ico"/>
                      
        </head>
  <body class="composite">
    <div id="banner">
                                      <a href="./" id="bannerLeft">
                                                <img src="images/logo.png" alt="usb4java" />
                </a>
                              <a href="https://github.com/kayahr/usb4java/" id="bannerRight">
                                        <img src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" />
                </a>
            <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
            
                <div class="xleft">
        <span id="publishDate">Last Published: 2013-05-04</span>
                  &nbsp;| <span id="projectVersion">Version: 1.0.0</span>
                      </div>
            <div class="xright">                    <a href="http://javax-usb.sourceforge.net/" class="externalLink" title="javax.usb">javax.usb</a>
            |
                        <a href="http://www.libusb.org/" class="externalLink" title="libusb">libusb</a>
            |
                        <a href="http://www.libusbx.org/" class="externalLink" title="libusbx">libusbx</a>
              
            
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
            
                                <h5>usb4java</h5>
                  <ul>
                  <li class="none">
                          <a href="index.html" title="About">About</a>
            </li>
                  <li class="none">
            <strong>Quick start</strong>
          </li>
                  <li class="none">
                          <a href="faq.html" title="FAQ">FAQ</a>
            </li>
                  <li class="none">
                          <a href="configuration.html" title="Configuration">Configuration</a>
            </li>
                  <li class="none">
                          <a href="nativelibs.html" title="Native libs">Native libs</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                                                                                                      <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                      <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                   
            
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>Installation<a name="Installation"></a></h2><p>Download the latest <i>usb4java.jar</i> and put it into your class path. Since version 0.5.0 you no longer need to care about the native libraries. They are included in the JAR file and will be used from there.</p><p>If you are using the high-level <i>javax.usb</i> API then you also need the <i>jsr80.jar</i> which can be downloaded from the <a class="externalLink" href="http://javax-usb.sourceforge.net/">javax.usb project site</a>. This JAR
        (Which is also included in the usb4java distribution tarball/zip
          as <em>usb-api.jar</em>) must also be copied into your class path.</p><p>Another dependency needed since version 1.0.0 is <a class="externalLink" href="http://commons.apache.org/proper/commons-lang/">commons-lang v3</a>.</p></div><div class="section"><h2>The high-level API<a name="The_high-level_API"></a></h2><p>The high-level API implements the <a class="externalLink" href="http://javax-usb.sourceforge.net/">javax.usb (JSR-80)</a> standard. It is recommended to use this API because it is object-oriented, event-driven and uses exceptions for error-handling instead of negative return values like the low-level API. Another advantage is that you may switch to a different <i>javax.usb</i> implementation later without changing your code. For example instead of using <i>usb4java</i> you may try out the reference implementation for Linux and Windows.</p><div class="section"><h3>Configuration<a name="Configuration"></a></h3><p>To use the <i>usb4java</i> implementation you have to create a file named <i><a href="./configuration.html">javax.usb.properties</a></i> in the root of your class path with the following content:</p><div class="source"><pre>javax.usb.services = de.ailis.usb4java.Services </pre></div></div><div class="section"><h3>Finding USB devices<a name="Finding_USB_devices"></a></h3><p>USB devices are managed in a tree. The root of this tree is a virtual USB hub to which all physical root hubs are connected. More hubs can be connected to these root hubs and any hub can have a number of connected USB devices.</p><p>The following source shows how to iterate over all devices: </p><div class="source"><pre>public class Dump
{
    private static void dump(UsbDevice device)
    {
        UsbDeviceDescriptor desc = device.getUsbDeviceDescriptor();
        System.out.format(&quot;%04x:%04x%n&quot;, desc.idVendor() &amp; 0xffff, desc.idProduct() &amp; 0xffff);
        if (device.isUsbHub())
        {
            UsbHub hub = (UsbHub) device;
            for (UsbDevice child : (List&lt;UsbDevice&gt;) hub.getAttachedUsbDevices())
            {
                dump(child);
            }
        }
    }

    public static void main(String[] args) throws UsbException
    {
        UsbServices services = UsbHostManager.getUsbServices();
        UsbHub rootHub = services.getRootUsbHub();
        dump(rootHub);
    }
}</pre></div><p>Often you need to search for a specific device before working with it. Here is an example how to scan the device tree for the first device with a specific vendor and product id. It can be easily expanded to check for specific device classes or whatever:</p><div class="source"><pre>public UsbDevice findDevice(UsbHub hub, short vendorId, short productId)
{
    for (UsbDevice device : (List&lt;UsbDevice&gt;) hub.getAttachedUsbDevices())
    {
        UsbDeviceDescriptor desc = device.getUsbDeviceDescriptor();
        if (desc.idVendor() == vendorId &amp;&amp; desc.idProduct() == productId) return device;
        if (device.isUsbHub())
        {
            device = findDevice((UsbHub) device, vendorId, productId);
            if (device != null) return device;
        }
    }
    return null;
}</pre></div></div><div class="section"><h3>Communicate via the Default Control Pipe <a name="Communicate_via_the_Default_Control_Pipe"></a></h3><p>This example reads the current configuration number from a device:</p><div class="source"><pre>UsbControlIrp irp = device.createUsbControlIrp(
    (byte) (UsbConst.REQUESTTYPE_DIRECTION_IN
          | UsbConst.REQUESTTYPE_TYPE_STANDARD
          | UsbConst.REQUESTTYPE_RECIPIENT_DEVICE),
    UsbConst.REQUEST_GET_CONFIGURATION,
    (short) 0,
    (short) 0
    );
irp.setData(new byte[1]);
device.syncSubmit(irp);
System.out.println(irp.getData()[0]);</pre></div></div><div class="section"><h3>More information about the high-level API<a name="More_information_about_the_high-level_API"></a></h3><ul><li><a href="./apidocs/index.html">API documentation of usb4java</a></li><li><a class="externalLink" href="http://javax-usb.sourceforge.net/">javax-usb website</a></li></ul></div></div><div class="section"><h2>The low-level API<a name="The_low-level_API"></a></h2><p>It is recommended to use the high-level javax.usb API but there are situations where you might want to use the low-level API instead. For example if you are already familiar with libusb or if you are porting a C program to Java then it might be easier to use the low-level API which is based on libusb version 1.0.</p><p>All global functions and constants of libusb are defined as static members of the class <a href="./apidocs/de/ailis/usb4java/libusb/LibUsb.html">de.ailis.usb4java.libusb.LibUsb</a>. All structures of libusb are defined in separate classes which are named similar to the original struct names but without underscores, with upper case names and with the libusb prefix removed. For example the struct <i>libusb_device_handle</i> is defined in the class <a href="./apidocs/de/ailis/usb4java/libusb/DeviceHandle.html">DeviceHandle</a>. Struct members are represented by static methods in the corresponding class.</p><p>The following notable differences exists between the <i>libusb 1.0 API</i> and the low-level API of <i>usb4java</i>:</p><ul><li><i>interface</i> in the configuration descriptor is named <i>iface</i> because <i>interface</i> is a reserved word in Java.</li><li><i>MaxPower</i> in the configuration descriptor is named <i>bMaxPower</i> to be compatible to the USB specification and because method names starting with upper-case letters are quite unusual in Java.</li><li>Whenever libusb expects a byte pointer and a length you have to use a direct Java NIO ByteBuffer instead.</li><li>Methods which are returning a string through a byte buffer which was passed as argument have additional simplified overloaded method equivalents which are returning a Java String directly.</li><li>Currently the asynchronous functions of libusb are not wrapped by usb4java. This may change in the future (Some help here is highly appreciated). So currently asynchronous communication is only possible with the high-level API which uses the synchronous libusb functions in Java threads.</li></ul><div class="section"><h3>More information about the low-level API<a name="More_information_about_the_low-level_API"></a></h3><ul><li><a href="./apidocs/de/ailis/usb4java/libusb/package-summary.html">Low-level API documentation of usb4java</a></li><li><a class="externalLink"
href="http://libusb.sourceforge.net/api-1.0/">API documentatiaon of libusb</a></li></ul></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                    2011-2013
                        <a href="http://www.ailis.de/~k/">Klaus Reimer</a>.
            All Rights Reserved.      
            
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
